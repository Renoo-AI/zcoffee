<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Z COFFEE | Sécurité</title>

    <!-- Favicon Premium Bicolore avec Z -->
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><clipPath id='s'><rect width='100' height='100' rx='30'/></clipPath></defs><g clip-path='url(%23s)'><rect width='50' height='100' fill='%232d2a26'/><rect x='50' width='50' height='100' fill='%23b48c68'/><text y='72' x='50' text-anchor='middle' font-family='Georgia,serif' font-weight='900' font-size='65' fill='%23faf9f6'>Z</text></g></svg>">

    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Plus+Jakarta+Sans:wght@200..800&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --bg: #faf9f6;
            --text: #2d2a26;
            --accent: #b48c68;
            --border: rgba(180, 140, 104, 0.15);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100dvh;
            overflow: hidden;
            position: relative;
        }

        .serif {
            font-family: 'Playfair Display', serif;
        }

        /* Effet de grain papier signature */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 100;
        }

        .gate-card {
            background: white;
            padding: 3.5rem 2.5rem;
            border-radius: 3rem;
            box-shadow: 0 40px 100px -20px rgba(45, 42, 38, 0.1);
            width: 100%;
            max-width: 420px;
            text-align: center;
            border: 1px solid var(--border);
            z-index: 10;
            opacity: 0;
            transform: translateY(20px);
            animation: reveal 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes reveal {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .key-input {
            width: 100%;
            background: #fdfbf7;
            border: 1px solid rgba(180, 140, 104, 0.1);
            padding: 1.5rem;
            border-radius: 1.25rem;
            text-align: center;
            font-size: 1.2rem;
            letter-spacing: 0.6em;
            outline: none;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            color: var(--text);
        }

        .key-input:focus {
            border-color: var(--accent);
            background: white;
            box-shadow: 0 10px 30px -10px rgba(180, 140, 104, 0.15);
            transform: scale(1.02);
        }

        .btn-enter {
            background: var(--text);
            color: white;
            width: 100%;
            padding: 1.4rem;
            border-radius: 1.25rem;
            margin-top: 2rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.25em;
            font-size: 0.75rem;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            box-shadow: 0 15px 30px -5px rgba(45, 42, 38, 0.2);
            cursor: pointer;
        }

        .btn-enter:hover {
            background: var(--accent);
            transform: translateY(-3px);
            box-shadow: 0 20px 40px -5px rgba(180, 140, 104, 0.3);
        }

        .btn-enter:active {
            transform: translateY(0) scale(0.98);
        }

        /* Animation Secousse pour erreur */
        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-8px);
            }

            75% {
                transform: translateX(8px);
            }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        .brand-icon {
            filter: drop-shadow(0 10px 15px rgba(45, 42, 38, 0.1));
            transition: transform 0.6s ease;
        }

        .brand-icon:hover {
            transform: rotate(10deg);
        }
    </style>
</head>

<body>

    <div class="gate-card" id="card">
        <!-- Logo Iconique Z -->
        <div class="mb-8 flex justify-center">
            <svg width="64" height="64" viewBox="0 0 100 100" class="brand-icon">
                <defs>
                    <clipPath id="logo-clip">
                        <rect width="100" height="100" rx="30" />
                    </clipPath>
                </defs>
                <g clip-path="url(#logo-clip)">
                    <rect width="50" height="100" fill="#2d2a26" />
                    <rect x="50" width="50" height="100" fill="#b48c68" />
                    <text y="72" x="50" text-anchor="middle" font-family="Georgia, serif" font-weight="900"
                        font-size="65" fill="#faf9f6">Z</text>
                </g>
            </svg>
        </div>

        <h1 class="serif text-3xl font-bold mb-2 tracking-tight">Accès Sécurisé</h1>
        <p class="text-[10px] opacity-40 uppercase tracking-[0.3em] font-bold mb-10">Signature Numérique Requise</p>

        <div class="relative">
            <input type="password" id="keyInput" class="key-input" placeholder="••••••••" autofocus autocomplete="off">
        </div>

        <button onclick="verifyKey()" class="btn-enter" id="btn">Déverrouiller</button>

        <p id="error"
            class="text-red-400 text-[10px] mt-6 font-bold uppercase tracking-widest hidden opacity-0 transition-opacity duration-300">
            Clé invalide</p>

        <div class="mt-12">
            <p class="text-[9px] uppercase tracking-[0.4em] opacity-20 font-bold">Z COFFEE • Maison de Café</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { firebaseConfig } from "./js/firebase-config.js";

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const input = document.getElementById('keyInput');
        const err = document.getElementById('error');
        const card = document.getElementById('card');
        const btn = document.getElementById('btn');

        window.verifyKey = async () => {
            const val = input.value.trim();

            btn.disabled = true;
            btn.style.opacity = "0.7";

            if (val === '16122010') {
                try {
                    await signInAnonymously(auth);
                    sessionStorage.setItem('key_cleared', 'true');
                    sessionStorage.setItem('admin_authenticated', 'true');
                    sessionStorage.setItem('auth_timestamp', Date.now().toString());

                    card.style.transform = "scale(0.95) translateY(-20px)";
                    card.style.opacity = "0";
                    card.style.transition = "all 0.6s ease";

                    setTimeout(() => {
                        window.location.href = 'admin/dashboard.html';
                    }, 500);
                } catch (e) {
                    console.error(e);
                    alert("Erreur de connexion.");
                    btn.disabled = false;
                    btn.style.opacity = "1";
                }
            } else {
                // Gestion de l'erreur avec animation de secousse
                err.classList.remove('hidden');
                setTimeout(() => err.style.opacity = "1", 10);

                card.classList.add('shake');
                input.style.borderColor = "#f87171";

                setTimeout(() => {
                    card.classList.remove('shake');
                    input.value = '';
                    input.style.borderColor = "rgba(180, 140, 104, 0.1)";
                    btn.disabled = false;
                    btn.style.opacity = "1";
                    input.focus();
                }, 500);
            }
        }

        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') verifyKey();
        });

        // Suppression de l'erreur quand on recommence à taper
        input.addEventListener('input', () => {
            err.style.opacity = "0";
            setTimeout(() => err.classList.add('hidden'), 300);
        });
    </script>
</body>

</html>